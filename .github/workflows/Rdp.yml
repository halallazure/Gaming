name: Connect-RDP
on: workflow_dispatch
jobs:
  build:
    runs-on: windows-latest
    steps:
    - name: Download AnyDesk
      run: curl.exe -L -o anydesk.exe https://download.anydesk.com/AnyDesk.exe

    - name: Set Password (Fix)
      run: |
        # In PowerShell, we pipe the password into AnyDesk to avoid parameter errors
        echo "MySafePassword123!" | ./anydesk.exe --set-password
      shell: pwsh

    - name: Get AnyDesk ID
      run: |
        # Give the service 15 seconds to start and generate an ID
        Start-Sleep -Seconds 15
        $ID = ./anydesk.exe --get-id
        Write-Host "------------------------------------------------" -ForegroundColor Green
        Write-Host "ANYDESK ID: $ID" -ForegroundColor Cyan
        Write-Host "PASSWORD: MySafePassword123!" -ForegroundColor Yellow
        Write-Host "------------------------------------------------" -ForegroundColor Green
      shell: pwsh

    - name: Keep Alive
      run: |
        Write-Host "Session is active. Connect from your Redmi Pad now."
        while($true){ Start-Sleep -Seconds 60 }
      shell: pwsh
