    - name: Force Get AnyDesk ID
      run: |
        # 1. Start the process and wait for it to generate the ID file
        ./anydesk.exe --service &
        Start-Sleep -Seconds 20
        
        # 2. Try method A: Standard CLI command
        $cmdID = ./anydesk.exe --get-id
        
        # 3. Try method B: Read from the internal system config file
        $configPath = "$env:AppData\AnyDesk\system.conf"
        if (Test-Path $configPath) {
            $fileID = Select-String -Path $configPath -Pattern "ad.anynet.id=(.*)" | ForEach-Object { $_.Matches.Value -replace "ad.anynet.id=","" }
        }

        # 4. Display the results clearly
        Write-Host "------------------------------------------------" -ForegroundColor Green
        if ($cmdID) { Write-Host "METHOD A (CLI) ID: $cmdID" -ForegroundColor Cyan }
        if ($fileID) { Write-Host "METHOD B (FILE) ID: $fileID" -ForegroundColor Cyan }
        if (!$cmdID -and !$fileID) { Write-Host "ERROR: ID not generated yet. Try re-running." -ForegroundColor Red }
        Write-Host "PASSWORD: MySafePassword123!" -ForegroundColor Yellow
        Write-Host "------------------------------------------------" -ForegroundColor Green
      shell: pwsh
