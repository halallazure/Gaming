    - name: Start AnyDesk Service
      run: |
        # Start AnyDesk as a background service to ensure ID generation
        ./anydesk.exe --service &
        Start-Sleep -Seconds 30
      shell: pwsh

    - name: Get AnyDesk ID (Two Methods)
      run: |
        # Method 1: Standard Command
        $ID_CMD = ./anydesk.exe --get-id
        
        # Method 2: Read from system.conf file (Deep Search)
        $confPath = "$env:AppData\AnyDesk\system.conf"
        if (Test-Path $confPath) {
          $ID_FILE = Select-String -Path $confPath -Pattern "ad.anynet.id=(.*)" | ForEach-Object { $_.Matches.Groups[1].Value }
        }

        Write-Host "------------------------------------------------" -ForegroundColor Green
        Write-Host "ANYDESK ID (CMD): $ID_CMD" -ForegroundColor Cyan
        Write-Host "ANYDESK ID (FILE): $ID_FILE" -ForegroundColor Cyan
        Write-Host "PASSWORD: MySafePassword123!" -ForegroundColor Yellow
        Write-Host "------------------------------------------------" -ForegroundColor Green
      shell: pwsh
