    - name: 1. Clear Old Data & Start
      run: |
        # Deleting the folder forces a fresh network handshake for a new ID
        if (Test-Path "$env:AppData\AnyDesk") { Remove-Item -Path "$env:AppData\AnyDesk" -Recurse -Force }
        ./anydesk.exe --service &
        Start-Sleep -Seconds 45
      shell: pwsh

    - name: 2. Direct File Extraction
      run: |
        # Locate the specific file where AnyDesk stores the ID
        $conf = "$env:AppData\AnyDesk\system.conf"
        if (Test-Path $conf) {
          $ID = Select-String -Path $conf -Pattern "ad.anynet.id=(.*)" | ForEach-Object { $_.Matches.Groups[1].Value }
          Write-Host "------------------------------------------------" -ForegroundColor Green
          Write-Host "YOUR ANYDESK ID IS: $ID" -ForegroundColor Cyan
          Write-Host "------------------------------------------------" -ForegroundColor Green
        } else {
          Write-Host "ERROR: system.conf not found. The app failed to start." -ForegroundColor Red
        }
      shell: pwsh
